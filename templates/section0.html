{% extends "base.html" %}
{% block content %}

<h2>ğŸ§ª í˜¼í•©ë¬¼ ë¬¼ì„±ì¹˜ ê³„ì‚°ê¸°</h2>

<form method="POST" class="form-container">

    <!-- 1. êµ¬ì„± ì„±ë¶„ -->
    <fieldset>
        <legend>1. êµ¬ì„± ì„±ë¶„ + ëª°ë¶„ìœ¨ ì…ë ¥</legend>
        <div id="components-area" class="component-group">
            <div class="component-row">
                <label>Component:</label>
                <select name="component">
                    <option value="Methane">Methane</option>
                    <option value="Ethane">Ethane</option>
                    <option value="Propane">Propane</option>
                    <option value="Butane">Butane</option>
                    <option value="Nitrogen">Nitrogen</option>
                    <option value="CarbonDioxide">Carbon Dioxide</option>
                </select>
                <label>Mole Fraction:</label>
                <input type="number" name="mole_fraction" step="any" min="0" max="1" required>
            </div>
        </div>
        <button type="button" onclick="addComponent()">â• ì„±ë¶„ ì¶”ê°€</button>
    </fieldset>

    <!-- 2. ì˜¨ë„/ì••ë ¥ -->
    <fieldset>
        <legend>2. ì˜¨ë„ ë° ì••ë ¥ ì…ë ¥</legend>
        <div class="input-group">
            <label>ì˜¨ë„ (Â°C):</label>
            <input type="number" name="T" step="any" required>
            <label>ì••ë ¥ (bar):</label>
            <input type="number" name="P" step="any" required>
        </div>
    </fieldset>

    <!-- ê³„ì‚° ë²„íŠ¼ -->
    <button type="submit" class="submit-btn">ğŸ“Š ê³„ì‚°í•˜ê¸°</button>
</form>

<hr>

<!-- ê³„ì‚° ê²°ê³¼ ì¶œë ¥ -->
{% if result %}
<h3>ğŸ“„ ê³„ì‚° ê²°ê³¼</h3>

{% if result.error %}
<p style="color: red;">âš ï¸ ì˜¤ë¥˜: {{ result.error }}</p>
{% else %}
<table class="result-table">
    <thead>
        <tr>
            <th>ğŸ“Œ Property</th>
            <th style="text-align:right;">Value</th>
            <th>Unit</th>
        </tr>
    </thead>
    <tbody>
        {% for name, data in result.items() %}
        <tr>
            <td>{{ name }}</td>
            <td style="text-align: right;">
                {% if data.value is string %}
                    <span style="color: #f66;">{{ data.value }}</span>
                {% elif data.value is defined %}
                    {{ "{:,.5g}".format(data.value) }}
                {% else %}
                    -
                {% endif %}
            </td>
            <td>{{ data.unit or '-' }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endif %}
{% endif %}

<script>
function addComponent() {
    const area = document.getElementById('components-area');
    const row = document.createElement('div');
    row.className = 'component-row';
    row.innerHTML = `
        <label>Component:</label>
        <select name="component">
            <option value="Methane">Methane</option>
            <option value="Ethane">Ethane</option>
            <option value="Propane">Propane</option>
            <option value="Butane">Butane</option>
            <option value="Nitrogen">Nitrogen</option>
            <option value="CarbonDioxide">Carbon Dioxide</option>
        </select>
        <label>Mole Fraction:</label>
        <input type="number" name="mole_fraction" step="any" min="0" max="1" required>
    `;
    area.appendChild(row);
}
</script>

{% endblock %}